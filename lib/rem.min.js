var c=null,f="undefined"==typeof require?{}:exports;f.A=function(b){return JSON.parse(JSON.stringify(b))};f.modify=function(b,a){var d=f.A(b),e;for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(d[e]=b[e]);for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&(d[e]=a[e]);return d};f.z=function(b){function a(){return a.call.apply(a,arguments)}a.__proto__=b;return a};f.F=function(b){return JSON.stringify(b).replace(/[\u007f-\uffff]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})};
f.s=function(b,a){b.R=a;b.prototype=Object.create(a.prototype,{constructor:{value:b,enumerable:!1}})};f.k=c;function i(){}function k(b,a){return b.hasOwnProperty.call(b.j||(b.j={}),a)?b.j[a]:b.j[a]=[]}i.prototype.i=i.prototype.L=function(b,a){0!==this.v&&k(this,b).push(a)>(this.v||10)&&console&&console.warn("Possible EventEmitter memory leak detected. "+this.j[b].length+" listeners added. Use emitter.setMaxListeners() to increase limit.");this.l("newListener",b,a);return this};
i.prototype.l=function(b){for(var a=Array.prototype.slice.call(arguments,1),d=0,e=k(this,b).slice();d<e.length;d++)e[d].apply(this,a)};f.K=i;f.url={parse:c,c:c,host:function(b){return b.hostname&&b.hostname+(b.port?":"+b.port:"")},path:function(b){return b.pathname+(b.d?"?"+f.e.stringify(b.d):"")+(b.hash?"#"+encodeURIComponent(b.hash):"")}};
f.b={create:function(b){return f.b.url({method:"GET",headers:{"User-Agent":l.u},url:c,body:c},b)},url:function(b,a){"string"==typeof a&&(a=f.url.parse(a));b=f.modify(b,{url:b.url?f.modify(b.url,a):a});return f.modify(b,{headers:f.modify(b.headers,{Host:f.url.host(b.url)})})},body:function(b,a,d){if("object"==typeof d){if("form"==a||"application/x-www-form-urlencoded"==a)a="application/x-www-form-urlencoded",d=f.e.stringify(d);if("json"==a||"application/json"==a)a="application/json",d=f.F(d)}return f.modify(b,
{headers:f.modify(b.headers,{"Content-Type":a,"Content-Length":d.length}),body:d})},send:c};f.e={stringify:c,parse:c};f.path={join:c};f.C=function(b){try{return JSON.parse(fs.Q(path.join(__dirname,"../common",b+".json")))}catch(a){return c}};
"undefined"!=typeof require&&function(){f.k=function(a,b){var d=[];a.i("data",function(a){d.push(a)});a.i("end",function(){b(Buffer.concat(d))})};var b=require("url");f.url.parse=function(a){a=b.parse(""+a,!0);return{protocol:a.protocol,h:a.h,hostname:a.hostname,port:a.port,pathname:a.pathname,d:a.d||{},search:a.search,hash:a.hash}};f.url.c=function(a){return b.c(a)};var a=require("http"),d=require("https");require("querystring");f.b.send=function(b,g){var h=("https:"==b.url.protocol?d:a).b({method:b.method,
headers:b.headers,protocol:b.url.protocol,hostname:b.url.hostname,port:b.url.port,path:f.url.path(b.url)});h.i("response",function(a){3==(a.f/100|0)&&a.headers.location?f.b.send(f.b.url(b,a.headers.location),g):g&&g(c,a)});b.body!=c&&h.write(b.body);h.end();return h};f.e=require("querystring");f.path=require("path")}();
"undefined"==typeof require&&function(){function b(a){var b=0;this.statusText=a.statusText;this.f=a.status;a.onreadystatechange=function(){3==a.readyState&&(this.l("data",a.responseText.substr(b)),b=a.responseText.length);4==a.readyState&&(b<a.responseText.length&&this.l("data",a.responseText.substr(b)),this.l("end"))}.bind(this)}f.k=function(a,b){var e=[];a.i("data",function(a){e.push(a)});a.i("end",function(){b(e.join(""))})};f.url.parse=function(a){var b=document.createElement("a");b.href=a;return{protocol:b.protocol,
h:b.h,hostname:b.hostname,port:b.port,pathname:b.pathname,d:f.e.parse(b.search||""),hash:b.hash&&decodeURIComponent(b.hash.substr(1))}};f.url.c=function(a){var b=document.createElement("a");b.protocol=a.protocol;b.h=a.h;b.hostname=a.hostname;b.port=a.port;b.pathname=a.pathname;b.d=f.e.stringify(a.d);b.hash=a.hash;return b.href};f.e.parse=function(a){for(var b={},a=a.replace(/^\?/,"").replace(/\+/g," ").split("&"),e=0,g=a.length,h;e<g;e++)a[e]&&(h=a[e].split("="),b[decodeURIComponent(h[0])]=decodeURIComponent(h[1]));
return b};f.e.stringify=function(a){var b=[],e;for(e in a)b.push(encodeURIComponent(e)+(a[e]==c?"":"="+encodeURIComponent(a[e])));return b.join("&")};f.s(b,i);f.b.send=function(a,d){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(2==e.readyState){var a=new b(e);d(2!=(e.f/100|0)&&e.f,a)}};e.open(a.method,f.url.c(a.url),!0);for(var g in e.headers)e.setRequestHeader(g,e.headers[g]);e.send(a.body)};f.path.join=function(){var a=Array.prototype.slice.call(arguments),b=document.createElement("a");
b.href=window.location.href;b.pathname=a.join("/").replace(/\/+/,"/");return b.pathname.substr(a[0]&&"/"==a[0][0]?0:1)}}();var l="undefined"==typeof exports?{}:exports,f="undefined"==typeof require?f:require("./remutil");l.u="Mozilla/5.0 (compatible; REMbot/1.0; +http://rem.tcr.io/)";l.J=c;function n(b,a,d){this.D=a;this.data=d;this.type=b.c;this.f=Number(this.D.f);this.r=400<this.f?this.f:0;try{"xml"===this.type?(libxmljs||(libxmljs=require("libxmljs")),this.data=this.xml=libxmljs.P(""+this.data)):this.data=JSON.parse(""+this.data)}catch(e){this.r=e}}function o(b,a){this.t=a}
var p=function(){function b(){}b.prototype.n=function(a){this.g||(this.g={});(this.g.request||(this.g.request=[])).push(a)};b.prototype.t=function(a){var b=Array.prototype.slice.call(arguments,1);(this.g&&this.g[a]||[]).forEach(function(a){a.apply(this,b)}.bind(this));return this};return b}(),q=function(){function b(a,b){this.a=a;this.m=b||{};this.key=this.m.key;this.G=this.m.G;this.c=this.m.c||"json";this.a.o||(this.a.o={N:{}});if(!this.a.o[this.c])throw Error('Format "'+this.c+'" not available. Please specify an available format in the options parameter.');
this.a=f.modify(this.a,this.a.o[this.c]);this.a.w&&this.n(function(a){a.url.pathname=this.a.w+a.url.pathname});this.a.H&&this.n(function(a){a.url.pathname=a.url.pathname+this.a.H});this.a.q&&this.n(function(a){var b=this.a.q,d;for(d in b)a.url.d[d]=this.m[d]});this.a.O&&this.n(function(a){var b=this.a.q,d;for(d in b)a.url.d[d]=b[d]})}f.s(b,p);b.prototype.B=function(a){return a()};b.prototype.call=function(){var a=Array.prototype.slice.call(arguments),b="object"==typeof a[a.length-1]?a.pop():{},a=
f.path.join.apply(c,a);return new o(f.b.create({d:b,pathname:a}),function(a,b){var d=this;return d.B(function(){var m=a.url.pathname.replace(/^(?!\/)/,"/");if(Array.isArray(d.a.p)){var j="";d.a.p.some(function(a){if("string"==typeof a)return j=a,!0;if(m.match(RegExp(a[0])))return j=a[1],!0})}else j=""+d.a.p;a=f.b.url(a,f.url.parse(j));a=f.b.url(a,{pathname:f.path.join(a.url.pathname,m)});d.t("request",a);d.send(a,function(a,e,j){if(b)return a=new n(d,j,e),b(a.r,a.data,a)})})}.bind(this))};b.prototype.send=
function(a,b){f.b.send(a,function(a,g){a?b(a,c,g):f.k(g,function(h){b(a,h,g)})})};return b}();l.I=q;l.create=function(b,a){return f.z(new q(b,a))};l.load=function(b,a,d){var a=a||"1",e=f.C(b);if(!e||!e[a])throw Error("Unable to find API "+b+"::"+a);e=e[a];e.id=b;e.version=a;return l.create(e,d)};
l.url=function(){var b=Array.prototype.slice.call(arguments),a="object"==typeof b[b.length-1]?b.pop():{},d=f.url.parse(b.shift());d.pathname=f.path.join.apply(c,[d.pathname].concat(b));d.d=a;return new o(f.b.create(d),function(a,b){f.b.send(a,b)})};l.M=f.k;
